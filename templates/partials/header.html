<!-- Include Alpine.js in base.html if not already included -->
<script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

<header class="bg-white shadow-md py-4">
  <div class="max-w-6xl mx-auto px-4 flex justify-between items-center">
    <a href="/" class="text-2xl font-bold theme-color-1">MyNewsletter AI</a>

    <div class="flex gap-6 items-center">
      <a href="/pricing" class="text-sm text-gray-700 hover:text-blue-700 transition">Pricing</a>

      {% if session['user_id'] %}
        <!-- Avatar + Dropdown -->
        <div class="relative inline-block" x-data="{ open: false }">
          <button 
            @click="open = !open"
            class="w-10 h-10 rounded-full bg-blue-600 text-white font-semibold text-lg flex items-center justify-center relative"
          >
            {{ session['email'][0]|upper }}

            <!-- Chevron Icon -->
            <svg 
              class="absolute -right-5 top-1/2 transform -translate-y-1/2 w-4 h-4 text-black transition-transform duration-200"
              :class="{ 'rotate-180': open }"
              fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
            >
              <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
            </svg>
          </button>

          <!-- Dropdown menu -->
          <div 
            x-show="open"
            @click.away="open = false"
            x-transition
            class="absolute right-0 mt-2 w-48 bg-white border rounded shadow-lg z-50"
          >
            <a href="/dashboard" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Dashboard</a>
            <a href="/account-settings" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Account Settings</a>
            <a href="/logout" class="block px-4 py-2 text-sm text-red-600 hover:bg-red-100">Log out</a>
          </div>
        </div>

      {% else %}
        <!-- Unauthenticated Links -->
        <a href="/register" class="btn-outline text-sm">Register Now</a>
        <a href="/login" class="theme-color-1 hover:text-blue-800 transition text-sm">Sign In</a>
      {% endif %}
    </div>
  </div>
</header>
